---
import Icon from "./Icon.astro";
---

<button
    id="theme-toggle"
    class="group fixed bottom-[4.5rem] left-0 z-9999 h-11 flex items-center bg-bg-primary border-2 border-l-0 border-text-primary rounded-r-xl cursor-pointer transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)] transform -translate-x-[calc(100%-3.2rem)] hover:translate-x-0 shadow-[4px_0_12px_rgba(0,0,0,0.1)] overflow-hidden pl-4 pr-2 w-auto"
    aria-label="Toggle Theme"
>
    <span
        class="text-xs font-mono font-bold text-text-primary tracking-widest whitespace-nowrap mr-3"
        >THEME</span
    >
    <div
        class="w-8 h-8 rounded-lg bg-text-primary text-bg-primary flex items-center justify-center shrink-0 overflow-hidden relative group-hover:scale-90 transition-transform"
    >
        <Icon name="Sun" size={16} class="icon-sun" />
        <Icon name="Moon" size={16} class="icon-moon" />
    </div>
</button>

<script>
    const toggle = document.getElementById("theme-toggle");
    const html = document.documentElement;

    // Load saved theme or default to light
    const saved = localStorage.getItem("theme");
    if (saved === "dark") {
        html.setAttribute("data-theme", "dark");
    }

    toggle?.addEventListener("click", () => {
        const isDark = html.getAttribute("data-theme") === "dark";
        if (isDark) {
            html.removeAttribute("data-theme");
            localStorage.setItem("theme", "light");
        } else {
            html.setAttribute("data-theme", "dark");
            localStorage.setItem("theme", "dark");
        }
    });
</script>
